
@model CORE.JGC.Models.MsAsset[]
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script>
    function fnExcelReport() {
        var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
        var textRange; var j = 0;
        tab = document.getElementById('datatable'); // id of table

        for (j = 0 ; j < tab.rows.length ; j++) {
            tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
            //tab_text=tab_text+"</tr>";
        }

        tab_text = tab_text + "</table>";

        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");

        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
        {
            txtArea1.document.open("txt/html", "replace");
            txtArea1.document.write(tab_text);
            txtArea1.document.close();
            txtArea1.focus();
            sa = txtArea1.document.execCommand("SaveAs", true, "Say Thanks to Sumit.xls");
        }
        else                 //other browser not tested on IE 11
            sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));

        return (sa);
    }
</script>
<script>
    function AssetDetail(AssetCode) {
        $.ajax({
            url: '@Url.Action("AssetDetail", "Asset")',
            type: 'post',
            cache: false,
            async: true,
            data: { AssetCode: AssetCode },
            success: function (response) {
                window.location.href = "@Url.Action("Details", "Asset")";
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                $(".modal-body #peringatan1").text("Asset Detail Error..");
                $('#btncaution').click(function (e) {
                    $('#Alert1').modal('hide');
                })
                $("#Alert1").modal();
            }
        });
    }
</script>
<div class="right_col" role="main">
    <div class="">
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="menusect">
                        <h5>
                            Assets •
                            <a href="/asset" class="activemenu">List of Assets</a>
                        </h5>
                    </div>
                    <div class="x_title">
                        <h2>All Assets</h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <p class="text-muted font-13 m-b-30">
                            <div class="mgbtm20">
                                <a href="/asset/create" class="btn btn-success btn-cust">Create New</a>
                                <button type="button" class="btn btn-success btn-cust" onclick="fnExcelReport();"><i class="fa fa-download icon-white"></i> Export to Excel</button>
                                <iframe id="txtArea1" style="display:none"></iframe>
                            </div>
                        </p>
                        <table id="datatable" class="table table-striped table-bordered bulk_action">
                            <thead>
                                <tr>
                                    <th>Asset Tag ID</th>
                                    <th>Asset Name</th>
                                    <th>Brand</th>
                                    <th>Site</th>
                                    <th>Location</th>
                                    <th>Floor</th>
                                    <th>Supplier</th>
                                    <th>Purchase Date</th>
                                    <th>Purchase Price</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>

                                        <td><a id="assetmodel" onclick="AssetDetail('@Html.DisplayFor(modelItem => item.AssetCode)')">@Html.DisplayFor(modelItem => item.AssetCode)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.AssetName)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.AssetBrandCode)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.SiteName)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.LocationName)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.Floor)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.SupplierCode)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.PurchaseDate)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.PurchasePrice)</a></td>
                                        <td><a href="#">@Html.DisplayFor(modelItem => item.bStatus)</a></td>
                                        
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL1 START -->
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content col-md-12 col-sm-12 col-xs-12 pdlr1">
            <div class="modal-header">
                <h4 class="modal-title ">ASST000001</h4>
            </div>
            <div class="modal-body col-md-12 col-sm-12 col-xs-12">

                <div class="col-md-4 col-sm-4 col-xs-12">
                    <img src="~/Content/res/images/laptop.jpg" alt="..." class="img-responsive" style="width:100%;">
                </div>

                <div class="col-md-4 col-sm-4 col-xs-12">
                    <form class="form-horizontal form-label-left">
                        <table id="datatable-checkbox" class="table table-striped table-bordered bulk_action">
                            <tbody>
                                <tr>
                                    <td><a href="">Purchase Date</a></td>
                                    <td><a href="#"> <b>20/04/2018</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Purchase From</a></td>
                                    <td><a href="#"> <b>Lazadong</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Purchase Price</a></td>
                                    <td><a href="#"> <b>Rp.7,500,000</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Brand</a></td>
                                    <td><a href="#"> <b>Sumsang</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Model</a></td>
                                    <td><a href="#"> <b>Sumsang990</b> </a></td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </div>

                <div class="col-md-4 col-sm-4 col-xs-12">
                    <form class="form-horizontal form-label-left">
                        <table id="datatable-checkbox" class="table table-striped table-bordered bulk_action">
                            <tbody>
                                <tr>
                                    <td><a href="">Serial No</a></td>
                                    <td><a href="#"> <b>2193819319</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Site</a></td>
                                    <td><a href="#"> <b>Jekardah</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Location</a></td>
                                    <td><a href="#"> <b>Jekardah</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Category</a></td>
                                    <td><a href="#"> <b>Leptop</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Department</a></td>
                                    <td><a href="#"> <b>IT</b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Assigned to</a></td>
                                    <td><a href="#"> <b></b> </a></td>
                                </tr>
                                <tr>
                                    <td><a href="">Status</a></td>
                                    <td><a href="#"> <b>Leased</b> </a></td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </div>

                <div class="ln_solid col-md-12 col-sm-12 col-xs-12"></div>
                <div class="form-group col-md-12 col-sm-12 col-xs-12 pdlr0">
                    <div class="row col-md-12 col-sm-12 col-xs-12 pdlr0" style="text-align:right;">
                        <button type="button" class="btn btn-primary">Close</button>
                        <a href="/asset/details" class="btn btn-success">More Details</a>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>
<!-- MODAL1 END -->

@RenderPage("~/Views/Shared/_FooterLayout.cshtml")

<script type="text/javascript">
      $(document).ready(function(){
          $("#assetmodel").click(function () {
              $("#myModal").modal();
          });
          $("#assetmodel2").click(function () {
              $("#myModal").modal();
          });
          $("#assetmodel3").click(function () {
              $("#myModal").modal();
          });
      });

      $("#check-all").click(function () {
          $(".checks").prop('checked', $(this).prop('checked'));
      });

</script>